{{/* Determine header image based on category */}}
{{ $headerImage := "/headers/home.png" }}
{{ $cat := "" }}

{{/* Get category from page or taxonomy */}}
{{ if .IsPage }}
    {{ with .Params.categories }}
        {{ $cat = index . 0 | lower }}
    {{ end }}
{{ else if .Data.Term }}
    {{/* This is a taxonomy/category page */}}
    {{ $cat = .Data.Term | lower }}
{{ end }}

{{/* Map category to header image */}}
{{ if $cat }}
    {{ if eq $cat "health" }}
        {{ $headerImage = "/headers/health.png" }}
    {{ else if eq $cat "tabletop" }}
        {{ $headerImage = "/headers/tabletop.png" }}
    {{ else if eq $cat "gaming" }}
        {{ $headerImage = "/headers/gaming.png" }}
    {{ else if eq $cat "personal" }}
        {{ $headerImage = "/headers/home.png" }}
    {{ else if eq $cat "clown" }}
        {{ $headerImage = "/headers/clown.png" }}
    {{ else if eq $cat "writing" }}
        {{ $headerImage = "/headers/writing.png" }}
    {{ else if eq $cat "cooking" }}
        {{ $headerImage = "/headers/cooking.png" }}
    {{ else if eq $cat "music" }}
        {{ $headerImage = "/headers/music.png" }}
    {{ else if eq $cat "travel" }}
        {{ $headerImage = "/headers/travel.png" }}
    {{ else if eq $cat "reading" }}
        {{ $headerImage = "/headers/reading.png" }}
    {{ else if eq $cat "crafting" }}
        {{ $headerImage = "/headers/crafting.png" }}
    {{ else if eq $cat "adhd" }}
        {{ $headerImage = "/headers/adhd.png" }}
    {{ else if eq $cat "pets" }}
        {{ $headerImage = "/headers/pets.png" }}
    {{ else if eq $cat "tech" }}
        {{ $headerImage = "/headers/tech.png" }}
    {{ else }}
        {{ $headerImage = "/headers/default.png" }}
    {{ end }}
{{ end }}

{{/* Check for video version of header */}}
{{ $headerVideo := replace $headerImage ".png" ".mp4" }}

<header class="site-header">
    <div class="header-container">
        <div class="header-image" style="background-image: url('{{ $headerImage }}');">
            {{/* If video exists, add video element for hover effect */}}
            {{ $videoPath := printf "static%s" $headerVideo }}
            {{ if fileExists $videoPath }}
            <video class="header-video" muted loop playsinline preload="auto">
                <source src="{{ $headerVideo }}" type="video/mp4">
            </video>
            {{ end }}
            <h1 class="site-title">
                <a href="{{ .Site.BaseURL }}">{{ .Site.Title }}</a>
            </h1>
        </div>
        <div class="header-frame"></div>
    </div>
</header>

<script>
// Header video hover play/pause
(function() {
    const headerImage = document.querySelector('.header-image');
    const video = document.querySelector('.header-video');
    if (!headerImage || !video) return;

    headerImage.addEventListener('mouseenter', () => {
        video.play();
    });

    headerImage.addEventListener('mouseleave', () => {
        video.pause();
    });
})();
</script>

<nav class="site-nav">
    <button class="nav-hamburger" aria-label="Toggle menu" aria-expanded="false">
        <span class="hamburger-bar"></span>
        <span class="hamburger-bar"></span>
        <span class="hamburger-bar"></span>
    </button>
    <div class="nav-links">
        <a href="{{ .Site.BaseURL }}" class="nav-sign{{ if .IsHome }} active{{ end }}">
            <span>Home</span>
        </a>
        {{ range .Site.Menus.main }}
        {{ $isActive := or ($.IsMenuCurrent "main" .) ($.HasMenuCurrent "main" .) (eq $.RelPermalink .URL) (hasPrefix $.RelPermalink .URL) }}
        <a href="{{ .URL }}" class="nav-sign{{ if $isActive }} active{{ end }}">
            <span>{{ .Name }}</span>
        </a>
        {{ end }}
    </div>
</nav>
