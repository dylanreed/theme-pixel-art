{{/* Get first category and determine sprite */}}
{{ $category := "" }}
{{ with .Params.categories }}
    {{ $category = index . 0 | lower }}
{{ end }}

{{/* Check if this is archive view - only access isArchive on dicts */}}
{{ $isArchive := false }}
{{ if not .IsPage }}
    {{ if .isArchive }}
        {{ $isArchive = true }}
    {{ end }}
{{ end }}

{{/* Map categories to sprites - canonical list
     Category        Sprite Class    Sprite File
     ------------------------------------------------
     health          skele           skele-health.png
     tabletop        knight          knight - tabletop.png
     gaming          dragon          Dragon - Tabletop.png
     personal        clown           clown - clown.png
     clown           balloon         balloon dog - clown.png
     writing         quill           quill - Writing.png
     cooking         cauldron        cauldren - cooking.png
     music           banjo           banjo - music.png
     travel          adventure       Adventure - Travel.png
     reading         book            book-reading.png
     crafting        muse            Muse - Writing.png
     adhd            donkey          Donkey - Travel.png
     pets            cat             Cat - Health.png
     tech            tech            golem - tech.png
     (default)       bard            bard - music.png
*/}}
{{ $spriteClass := "bard" }}
{{ $spriteFile := "bard - music.png" }}

{{ if eq $category "health" }}
    {{ $spriteClass = "skele" }}
    {{ $spriteFile = "skele-health.png" }}
{{ else if eq $category "tabletop" }}
    {{ $spriteClass = "knight" }}
    {{ $spriteFile = "knight - tabletop.png" }}
{{ else if eq $category "gaming" }}
    {{ $spriteClass = "dragon" }}
    {{ $spriteFile = "Dragon - Tabletop.png" }}
{{ else if eq $category "personal" }}
    {{ $spriteClass = "clown" }}
    {{ $spriteFile = "clown - clown.png" }}
{{ else if eq $category "clown" }}
    {{ $spriteClass = "balloon" }}
    {{ $spriteFile = "balloon dog - clown.png" }}
{{ else if eq $category "writing" }}
    {{ $spriteClass = "quill" }}
    {{ $spriteFile = "quill - Writing.png" }}
{{ else if eq $category "cooking" }}
    {{ $spriteClass = "cauldron" }}
    {{ $spriteFile = "cauldren - cooking.png" }}
{{ else if eq $category "music" }}
    {{ $spriteClass = "banjo" }}
    {{ $spriteFile = "banjo - music.png" }}
{{ else if eq $category "travel" }}
    {{ $spriteClass = "adventure" }}
    {{ $spriteFile = "Adventure - Travel.png" }}
{{ else if eq $category "reading" }}
    {{ $spriteClass = "book" }}
    {{ $spriteFile = "book-reading.png" }}
{{ else if eq $category "crafting" }}
    {{ $spriteClass = "muse" }}
    {{ $spriteFile = "Muse - Writing.png" }}
{{ else if eq $category "adhd" }}
    {{ $spriteClass = "donkey" }}
    {{ $spriteFile = "Donkey - Travel.png" }}
{{ else if eq $category "pets" }}
    {{ $spriteClass = "cat" }}
    {{ $spriteFile = "Cat - Health.png" }}
{{ else if eq $category "tech" }}
    {{ $spriteClass = "tech" }}
    {{ $spriteFile = "golem - tech.png" }}
{{ end }}

<div class="{{ if $isArchive }}archive-sprite{{ else }}post-sprite{{ end }} sprite-{{ $spriteClass }}">
    <img src="/sprites/{{ $spriteFile }}" alt="Animated {{ $spriteClass }} sprite for {{ $category | default "default" }} category">
</div>
